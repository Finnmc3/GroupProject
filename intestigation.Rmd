---
title: "IDS investigation worksheet"
author: "by Team31: Finn, Tom, User3, User4 & User5"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
# Add any other libraries here



```


```{r load-data}
setwd("~/IDS/GroupProject/data/census+income")
adult_data <- read.csv("adult.data")
adult_test <- read.csv("adult.csv")

#Changing the variable names for adult data
colnames(adult_data) <- c("age", "workclass", "id", "education", "education-num", "marital-status", "occupation", "relationship", "race", "sex", "capital_gain", "capital_loss", "hours-per-week", "native-country", "class")

adult_data <- adult_data %>% 
  select(-capital_gain, -capital_loss)



#note that adult.data is just adult.tests with a few variables removed so we only need to use the adult data

view(adult_data)

#some questions about the data: income inequality between different races/genders/nationalities ; class based on type of degree ; correlation between class and age; correlation between race/gender and age E.G do certain races/genders live longer than others.
education_counts <- adult_data %>%
  group_by(education) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

adult_data$education <- adult_data$education %>% factor(levels = education_counts$education)

adult_data %>% ggplot() + geom_bar(mapping = aes(x = education, fill = class), position = "dodge") + theme(axis.text.x = element_text(angle = 45, hjust = 1))

#from this graph it looks as if bachelors degrees have the most people in upper class, however this does not take into account the fact that more people have bachelos in comparison to master, phd, etc..


#graph displaying income against race
adult_data %>% ggplot() + geom_bar(mapping = aes(x = race, fill = class), position = "dodge") + theme(axis.text.x = element_text(angle = 45, hjust = 1))



percentage_race_data <- adult_data %>%
  group_by(race, class) %>%
  summarize(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)


percentage_race <- ggplot(percentage_race_data, aes(x = race, y = percentage, fill = class)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), vjust = -0.5, position = position_dodge(width = 0.9)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(percentage_race)
#graph showing income against sex


adult_data %>% ggplot() + geom_bar(mapping = aes(x = sex, fill = class), position = "dodge") + theme(axis.text.x = element_text(angle = 45, hjust = 1))



percentage_sex_data <- adult_data %>%
  group_by(sex, class) %>%
  summarize(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)


percentage_sex <- ggplot(percentage_sex_data, aes(x = sex, y = percentage, fill = class)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), vjust = -0.5, position = position_dodge(width = 0.9)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(percentage_sex)
```
#Here we have created a program which predicts a persons class based on the other variable.
#The program is made using conditional probabilities so we can compare this model to that of a linear regression once we make a linear regression model.

conditional_probs <- with(adult_data, prop.table(table(class, race, sex, education), margin = 1))

#please put a space before enetering each value and also use capitals at start
new_individual <- data.frame(race = " Black", sex = " Male", education = " Bachelors")

# Calculate the conditional probabilities for both classes
conditional_probs_above_50K <- conditional_probs[" >50K", new_individual$race, new_individual$sex, new_individual$education]
conditional_probs_below_50K <- conditional_probs[" <=50K", new_individual$race, new_individual$sex, new_individual$education]

# Compare the conditional probabilities and classify the individual
if (conditional_probs_above_50K > conditional_probs_below_50K) {
  result = paste("class is >50K With probability", conditional_probs_above_50K, sep = " ")
  print(result)

} else {
  result = paste("Class is <= 50K With probability", condition_probs_below_50K, sep = " ")
  print(result)
}




